plugins {
id 'java'
id 'jacoco' // 1. JaCoCo í”ŒëŸ¬ê·¸ì¸ ì ìš©

// ğŸš¨ ìˆ˜ì • 1: Gradle 9.xì™€ í˜¸í™˜ë˜ëŠ” ìµœì‹  ë²„ì „ìœ¼ë¡œ ë³€ê²½
id 'org.sonarqube' version '5.1.1.4922' 


}

group = 'com.example'
version = '0.0.1-SNAPSHOT'

// ğŸš¨ ìˆ˜ì • 2: 'sourceCompatibility'ëŠ” 'java' ë¸”ë¡ ì•ˆì— ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
java {
sourceCompatibility = '17'
}

repositories {
mavenCentral()
}

// ğŸš¨ ìˆ˜ì • 3: JUnit 5 ì‹¤í–‰ì„ ìœ„í•œ ì˜¬ë°”ë¥¸ ì˜ì¡´ì„±
dependencies {
// JUnit BOM(Bill of Materials)ìœ¼ë¡œ ë²„ì „ ê´€ë¦¬
testImplementation platform('org.junit:junit-bom:5.10.0')

// í…ŒìŠ¤íŠ¸ ì‘ì„±ì— í•„ìš”í•œ API
testImplementation 'org.junit.jupiter:junit-jupiter'

// (ê°€ì¥ ì¤‘ìš”) í…ŒìŠ¤íŠ¸ ì‹¤í–‰ì„ ìœ„í•œ Launcher (ì´ì „ ë¹Œë“œ ì‹¤íŒ¨ ì›ì¸)
testRuntimeOnly 'org.junit.platform:junit-platform-launcher'

// (ê¶Œì¥) í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì—”ì§„
testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine'


}

test {
useJUnitPlatform()
// 3. 'test' íƒœìŠ¤í¬ê°€ ëë‚˜ë©´ JaCoCo ë¦¬í¬íŠ¸ë¥¼ ìƒì„±í•˜ë„ë¡ ì„¤ì •
finalizedBy jacocoTestReport
}

jacocoTestReport {
dependsOn test // jacocoTestReportëŠ” test íƒœìŠ¤í¬ì— ì˜ì¡´
reports {
// 4. SonarQubeê°€ ì½ì„ XML ë¦¬í¬íŠ¸ ìƒì„±
xml.required = true
// (ì„ íƒ) ì‚¬ëŒì´ ë³¼ HTML ë¦¬í¬íŠ¸ë„ ìƒì„±
html.required = true
}
}

sonar {
properties {
// 5. ì‚¬ìš©ì ê°’ ì ìš© (rybbit3)
property "sonar.projectKey", "rybbit3"
property "sonar.organization", "rybbit3"
property "sonar.host.url", "https://sonarcloud.io"

    // 6. SonarQubeì—ê²Œ JaCoCo ë¦¬í¬íŠ¸ íŒŒì¼ì˜ ìœ„ì¹˜ë¥¼ ì•Œë ¤ì¤Œ (í•µì‹¬!)
    property "sonar.coverage.jacoco.xmlReportPaths", "${buildDir}/reports/jacoco/test/jacocoTestReport.xml"
}


}